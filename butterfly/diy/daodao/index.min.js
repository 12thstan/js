/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/daodaoplus@1.1.7/static/js/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function ajaxpromise({URL:e,method:t="GET",data:n=null,contentType:a=!1}){return new Promise((function(o,s){var l=new XMLHttpRequest;l.open(t,e,!0),l.send(n),l.contentType=a,l.onreadystatechange=function(){4==l.readyState&&(200===l.status?o(l.responseText):s(l.responseText))}}))}function getDate(){return(new Date).Format("yyyy-MM-dd hh:mm:ss")}function getBrowserInfo(){var e,t={},n=navigator.userAgent.toLowerCase();return(e=n.match(/edg\/([\d.]+)/))?t.edge=e[1]:(e=n.match(/rv:([\d.]+)\) like gecko/))||(e=n.match(/msie ([\d.]+)/))?t.ie=e[1]:(e=n.match(/firefox\/([\d.]+)/))?t.firefox=e[1]:(e=n.match(/chrome\/([\d.]+)/))?t.chrome=e[1]:(e=n.match(/opera.([\d.]+)/))?t.opera=e[1]:(e=n.match(/version\/([\d.]+).*safari/))&&(t.safari=e[1]),t.edge?{broswer:"Edge",version:t.edge}:t.ie?{broswer:"IE",version:t.ie}:t.firefox?{broswer:"Firefox",version:t.firefox}:t.chrome?{broswer:"Chrome",version:t.chrome}:t.opera?{broswer:"Opera",version:t.opera}:t.safari?{broswer:"Safari",version:t.safari}:{broswer:"",version:"0"}}function mySelector(e){return!0===arguments[1]?document.querySelectorAll(e):document.querySelector(e)}function makeData(){var e=new XMLHttpRequest;return function(t,n,a,o){e.open(t,n,!0),e.setRequestHeader("Content-type","application/json;charset=UTF-8"),e.withCredentials=!0,e.send(a),e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=JSON.parse(e.responseText);"function"==typeof o&&o(t)}}}}function Daodao(e,t){this.url=e,this.cnt=t,this.init=function(e){var t;dataGetter("get",`${this.url}/api/query/${this.cnt}`,null,(function(t){if(console.log(t),daodao.logined=t.login,!document.getElementById("template")){var n=document.createElement("script");n.id="template",n.type="text/html",n.innerHTML=' {{each list item index}}<div class="item" id={{item["_id"]}} ><div id="del{{item[\'_id\']}}"  class="delete_right"><svg t="1591347978744"                viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14459"                width="20" height="20" style="display: inline"                ><path                    d="M512 883.2A371.2 371.2 0 1 0 140.8 512 371.2 371.2 0 0 0 512 883.2z m0 64a435.2 435.2 0 1 1 435.2-435.2 435.2 435.2 0 0 1-435.2 435.2z"                    p-id="14460" fill="#efefef"></path><path                    d="M557.056 512l122.368 122.368a31.744 31.744 0 1 1-45.056 45.056L512 557.056l-122.368 122.368a31.744 31.744 0 1 1-45.056-45.056L466.944 512 344.576 389.632a31.744 31.744 0 1 1 45.056-45.056L512 466.944l122.368-122.368a31.744 31.744 0 1 1 45.056 45.056z"                    p-id="14461" fill="#efefef"></path></svg></div><p class="datatime">{{item["date"]}}</p><p class="datacont">                {{@item["content"]}}</p><p class="datafrom"><small><i class="fas fa-tools"></i>{{item["from"]}}</small></p></div>    {{/each}}',document.body.appendChild(n)}var a=template("template",{list:t.data});mySelector("#bbitems").innerHTML=a,"function"==typeof e&&e(),document.getElementById("ddloading").style.display="none",Array.from(document.getElementsByClassName("delete_right")).forEach((e=>{e.addEventListener("click",(function(){daodao.logined?daodao.delOne(e):mySelector("button").click()}))}))})),mySelector("button").onclick=function(){mySelector(".popOut").style.display="block",mySelector(".popOut").className="popOut ani",mySelector(".popOutBg").style.display="block"},mySelector(".popOut  .logoff").onclick=function(){mySelector(".popOut").style.display="none",mySelector(".popOutBg").style.display="none"},mySelector(".popOutBg").onclick=function(){mySelector(".popOut").style.display="none",mySelector(".popOutBg").style.display="none",document.getElementsByClassName("createbox")[0].style.display="none"},document.getElementsByClassName("dd-create")[0].onclick=function(){1!==daodao.logined?mySelector("button").click():(document.getElementsByClassName("createbox")[0].style.display="block",mySelector(".popOutBg").style.display="block")},mySelector("#ddloginbox").onsubmit=function(){return daodao.login()},document.getElementsByClassName("dd-preview")[0].onclick=(t=1,function(){t?(t=0,document.getElementsByClassName("createContent")[0].innerHTML=marked(document.getElementsByClassName("Input_text")[0].value),document.getElementsByClassName("createMain")[0].style.display="none",document.getElementsByClassName("createContent")[0].style.display="block",document.getElementsByClassName("dd-preview")[0].innerText="编辑"):(document.getElementsByClassName("dd-preview")[0].innerText="预览",document.getElementsByClassName("createContent")[0].style.display="none",document.getElementsByClassName("createMain")[0].style.display="block",t=1)}),document.getElementsByClassName("dd-post")[0].onclick=function(){daodao.create()};let n=document.getElementById("up"),a=new FormData;n.onchange=function(){a.delete("image"),a.append("image",n.files[0]),document.getElementsByClassName("Input_text")[0].value+=` ![${a.getAll("image")[0].name}](uploading)`,ajaxpromise({URL:"https://7bu.top/api/upload",method:"POST",data:a}).then((function(e){document.getElementsByClassName("Input_text")[0].value=document.getElementsByClassName("Input_text")[0].value.replace(`![${a.getAll("image")[0].name}](uploading)`,`![${JSON.parse(e).data.name}](${JSON.parse(e).data.url})`)})).catch((function(e){alert("错误："+JSON.parse(e).data)}))}},this.login=function(){return dataGetter("post",`${this.url}/api/login`,JSON.stringify({username:mySelector("#username").value,password:mySelector("#password").value}),(function(e){1===e.code&&(daodao.logined=1,mySelector(".popOut").style.display="none",mySelector(".popOutBg").style.display="none"),alert(e.msg)})),!1},this.create=function(){if(""===document.getElementsByClassName("Input_text")[0].value)return 0;var e=getBrowserInfo();dataGetter("post",`${this.url}/api/create`,JSON.stringify({content:marked(document.getElementsByClassName("Input_text")[0].value),from:e.broswer+"/"+e.version,date:getDate()}),(function(e){console.log(e),alert(e.msg),e.code&&(document.getElementsByClassName("Input_text")[0].value="",mySelector(".popOutBg").click(),daodao.init())}))},this.delOne=function(e){if(console.log("删除 "+e.id),confirm("确定要删除吗？","")){var t=e.id.slice(3);dataGetter("post",`${this.url}/api/del`,JSON.stringify({id:t}),(function(e){if(e.code){document.getElementById(t);daodao.init()}alert(e.msg)}))}}}Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},"function"!=typeof dataGetter&&(window.dataGetter=makeData());
//# sourceMappingURL=/sm/0c664426dca160702d39672057269bdc0d5b0a308af31ec74baf64ffa24d7194.map